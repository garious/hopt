<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Transforms.DeadInstructionElimination</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Transforms-DeadInstructionElimination.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="src/Transforms-DeadInstructionElimination.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">hopt</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>Safe</td></tr></table><p class="caption">Transforms.DeadInstructionElimination</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Dead Instruction Elimination
</p><p>This optimization pass removes assignment statements that are 
   unreferenced by all later statements.  Unlike the LLVM version,
   this version also moves each instruction as closely as possible to
   the first instruction that references it.
</p><p>How it works:
</p><p>When a definition (i.e. assignment) is parsed, we pull it out of the basic
   block until another statement references it.  Then, for each statement, we
   lookup all definitions it uses and check for them in our list of
   unreferenced definitions.  If we find one, we push the definition back
   into the basic block, just before the statement that references it.
</p><p>For example:
</p><p>Line  Input         PassState          Output             Comment
   ----  --------      ---------          ------             -------
     1   %1 = 5        [%1 = 5]                              %1 may be unreferrenced
     2   %2 = 7        [%1 = 5, %2 = 7]                      %1 &amp; %2 may be unreferrenced
     3   %3 = %1       [%2 = 7, %3 = %1]  [%1 = 5]           %1 is used
     4   ret %3        [%2 = 7]           [%3 = %1, ret %3]  %3 is used, %2 is dropped
</p><p>Limitations:
</p><ol><li> If there is a chain of unreferenced definitions, this pass will only
         remove the first link in the chain.
      2. Code size: A redundant definition can be pulled into branch if both
         sides reference the definition for the first time.
</li></ol><p>Hindsight:
</p><p>This pass is probably more useful in improving spacial locality and
      reducing register pressure than removing dead instructions.
</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><span class="keyword">type</span> <a href="#t:PassState">PassState</a> = [(<a href="/usr/local/share/doc/ghc/html/libraries/base-4.6.0.0/Data-String.html#t:String">String</a>, <a href="LlvmData.html#t:Expr">Expr</a>)]</li><li class="src short"><a href="#v:name">name</a> :: <a href="/usr/local/share/doc/ghc/html/libraries/base-4.6.0.0/Data-String.html#t:String">String</a></li><li class="src short"><a href="#v:emptyState">emptyState</a> :: <a href="Transforms-DeadInstructionElimination.html#t:PassState">PassState</a></li><li class="src short"><a href="#v:chunk">chunk</a> :: <a href="/usr/local/share/doc/ghc/html/libraries/base-4.6.0.0/Control-Monad.html#t:Monad">Monad</a> m =&gt; <a href="LlvmData.html#t:Module">Module</a> -&gt; <a href="/Users/garious/Library/Haskell/ghc-7.6.1/lib/mtl-2.1.2/doc/html/Control-Monad-State-Lazy.html#t:StateT">StateT</a> <a href="Transforms-DeadInstructionElimination.html#t:PassState">PassState</a> m <a href="LlvmData.html#t:Module">Module</a></li><li class="src short"><a href="#v:toplevelEntity">toplevelEntity</a> :: <a href="/usr/local/share/doc/ghc/html/libraries/base-4.6.0.0/Control-Monad.html#t:Monad">Monad</a> m =&gt; <a href="LlvmData.html#t:ToplevelEntity">ToplevelEntity</a> -&gt; <a href="/Users/garious/Library/Haskell/ghc-7.6.1/lib/mtl-2.1.2/doc/html/Control-Monad-State-Lazy.html#t:StateT">StateT</a> <a href="Transforms-DeadInstructionElimination.html#t:PassState">PassState</a> m <a href="LlvmData.html#t:ToplevelEntity">ToplevelEntity</a></li><li class="src short"><a href="#v:stat">stat</a> :: <a href="/usr/local/share/doc/ghc/html/libraries/base-4.6.0.0/Control-Monad.html#t:Monad">Monad</a> m =&gt; <a href="LlvmData.html#t:Statement">Statement</a> -&gt; <a href="/Users/garious/Library/Haskell/ghc-7.6.1/lib/mtl-2.1.2/doc/html/Control-Monad-State-Lazy.html#t:StateT">StateT</a> <a href="Transforms-DeadInstructionElimination.html#t:PassState">PassState</a> m <a href="LlvmData.html#t:Block">Block</a></li><li class="src short"><a href="#v:vars">vars</a> :: <a href="LlvmData.html#t:Expr">Expr</a> -&gt; [<a href="/usr/local/share/doc/ghc/html/libraries/base-4.6.0.0/Data-String.html#t:String">String</a>]</li><li class="src short"><a href="#v:vars-39-">vars'</a> :: <a href="LlvmData.html#t:Expr">Expr</a> -&gt; [<a href="/usr/local/share/doc/ghc/html/libraries/base-4.6.0.0/Data-String.html#t:String">String</a>]</li><li class="src short"><a href="#v:pushStatement">pushStatement</a> :: <a href="/usr/local/share/doc/ghc/html/libraries/base-4.6.0.0/Control-Monad.html#t:Monad">Monad</a> m =&gt; <a href="/usr/local/share/doc/ghc/html/libraries/base-4.6.0.0/Data-String.html#t:String">String</a> -&gt; <a href="LlvmData.html#t:Expr">Expr</a> -&gt; <a href="/Users/garious/Library/Haskell/ghc-7.6.1/lib/mtl-2.1.2/doc/html/Control-Monad-State-Lazy.html#t:StateT">StateT</a> <a href="Transforms-DeadInstructionElimination.html#t:PassState">PassState</a> m ()</li><li class="src short"><a href="#v:popStatement">popStatement</a> :: <a href="/usr/local/share/doc/ghc/html/libraries/base-4.6.0.0/Control-Monad.html#t:Monad">Monad</a> m =&gt; <a href="/usr/local/share/doc/ghc/html/libraries/base-4.6.0.0/Data-String.html#t:String">String</a> -&gt; <a href="/Users/garious/Library/Haskell/ghc-7.6.1/lib/mtl-2.1.2/doc/html/Control-Monad-State-Lazy.html#t:StateT">StateT</a> <a href="Transforms-DeadInstructionElimination.html#t:PassState">PassState</a> m [<a href="LlvmData.html#t:Statement">Statement</a>]</li></ul></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:PassState" class="def">PassState</a> = [(<a href="/usr/local/share/doc/ghc/html/libraries/base-4.6.0.0/Data-String.html#t:String">String</a>, <a href="LlvmData.html#t:Expr">Expr</a>)]<a href="src/Transforms-DeadInstructionElimination.html#PassState" class="link">Source</a></p><div class="doc"><p>A list of unreferenced instructions.
   The String is a variable name, and
   the Expr is the value assigned to it.
</p></div></div><div class="top"><p class="src"><a name="v:name" class="def">name</a> :: <a href="/usr/local/share/doc/ghc/html/libraries/base-4.6.0.0/Data-String.html#t:String">String</a><a href="src/Transforms-DeadInstructionElimination.html#name" class="link">Source</a></p><div class="doc"><p>The name of this optimization pass
</p></div></div><div class="top"><p class="src"><a name="v:emptyState" class="def">emptyState</a> :: <a href="Transforms-DeadInstructionElimination.html#t:PassState">PassState</a><a href="src/Transforms-DeadInstructionElimination.html#emptyState" class="link">Source</a></p><div class="doc"><p>The initial state
</p></div></div><div class="top"><p class="src"><a name="v:chunk" class="def">chunk</a> :: <a href="/usr/local/share/doc/ghc/html/libraries/base-4.6.0.0/Control-Monad.html#t:Monad">Monad</a> m =&gt; <a href="LlvmData.html#t:Module">Module</a> -&gt; <a href="/Users/garious/Library/Haskell/ghc-7.6.1/lib/mtl-2.1.2/doc/html/Control-Monad-State-Lazy.html#t:StateT">StateT</a> <a href="Transforms-DeadInstructionElimination.html#t:PassState">PassState</a> m <a href="LlvmData.html#t:Module">Module</a><a href="src/Transforms-DeadInstructionElimination.html#chunk" class="link">Source</a></p><div class="doc"><p>Optimize a list of top-level entities
</p></div></div><div class="top"><p class="src"><a name="v:toplevelEntity" class="def">toplevelEntity</a> :: <a href="/usr/local/share/doc/ghc/html/libraries/base-4.6.0.0/Control-Monad.html#t:Monad">Monad</a> m =&gt; <a href="LlvmData.html#t:ToplevelEntity">ToplevelEntity</a> -&gt; <a href="/Users/garious/Library/Haskell/ghc-7.6.1/lib/mtl-2.1.2/doc/html/Control-Monad-State-Lazy.html#t:StateT">StateT</a> <a href="Transforms-DeadInstructionElimination.html#t:PassState">PassState</a> m <a href="LlvmData.html#t:ToplevelEntity">ToplevelEntity</a><a href="src/Transforms-DeadInstructionElimination.html#toplevelEntity" class="link">Source</a></p><div class="doc"><p>Optimize a top-level entity
</p></div></div><div class="top"><p class="src"><a name="v:stat" class="def">stat</a> :: <a href="/usr/local/share/doc/ghc/html/libraries/base-4.6.0.0/Control-Monad.html#t:Monad">Monad</a> m =&gt; <a href="LlvmData.html#t:Statement">Statement</a> -&gt; <a href="/Users/garious/Library/Haskell/ghc-7.6.1/lib/mtl-2.1.2/doc/html/Control-Monad-State-Lazy.html#t:StateT">StateT</a> <a href="Transforms-DeadInstructionElimination.html#t:PassState">PassState</a> m <a href="LlvmData.html#t:Block">Block</a><a href="src/Transforms-DeadInstructionElimination.html#stat" class="link">Source</a></p><div class="doc"><p>Optimize a statement
</p></div></div><div class="top"><p class="src"><a name="v:vars" class="def">vars</a> :: <a href="LlvmData.html#t:Expr">Expr</a> -&gt; [<a href="/usr/local/share/doc/ghc/html/libraries/base-4.6.0.0/Data-String.html#t:String">String</a>]<a href="src/Transforms-DeadInstructionElimination.html#vars" class="link">Source</a></p><div class="doc"><p>Given an expression, return the variable names it references
</p></div></div><div class="top"><p class="src"><a name="v:vars-39-" class="def">vars'</a> :: <a href="LlvmData.html#t:Expr">Expr</a> -&gt; [<a href="/usr/local/share/doc/ghc/html/libraries/base-4.6.0.0/Data-String.html#t:String">String</a>]<a href="src/Transforms-DeadInstructionElimination.html#vars%27" class="link">Source</a></p><div class="doc"><p>Given an expresion, if it is variable, return its name.  Otherwise, return an empty list
</p></div></div><div class="top"><p class="src"><a name="v:pushStatement" class="def">pushStatement</a> :: <a href="/usr/local/share/doc/ghc/html/libraries/base-4.6.0.0/Control-Monad.html#t:Monad">Monad</a> m =&gt; <a href="/usr/local/share/doc/ghc/html/libraries/base-4.6.0.0/Data-String.html#t:String">String</a> -&gt; <a href="LlvmData.html#t:Expr">Expr</a> -&gt; <a href="/Users/garious/Library/Haskell/ghc-7.6.1/lib/mtl-2.1.2/doc/html/Control-Monad-State-Lazy.html#t:StateT">StateT</a> <a href="Transforms-DeadInstructionElimination.html#t:PassState">PassState</a> m ()<a href="src/Transforms-DeadInstructionElimination.html#pushStatement" class="link">Source</a></p><div class="doc"><p>Push a statement that may be dead
</p></div></div><div class="top"><p class="src"><a name="v:popStatement" class="def">popStatement</a> :: <a href="/usr/local/share/doc/ghc/html/libraries/base-4.6.0.0/Control-Monad.html#t:Monad">Monad</a> m =&gt; <a href="/usr/local/share/doc/ghc/html/libraries/base-4.6.0.0/Data-String.html#t:String">String</a> -&gt; <a href="/Users/garious/Library/Haskell/ghc-7.6.1/lib/mtl-2.1.2/doc/html/Control-Monad-State-Lazy.html#t:StateT">StateT</a> <a href="Transforms-DeadInstructionElimination.html#t:PassState">PassState</a> m [<a href="LlvmData.html#t:Statement">Statement</a>]<a href="src/Transforms-DeadInstructionElimination.html#popStatement" class="link">Source</a></p><div class="doc"><p>Lookup a statement that is now known to be undead.  Remove it from the list of dead instructions.
</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.12.0</p></div></body></html>